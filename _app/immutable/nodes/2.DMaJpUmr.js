import{t as z,a as O,c as ye}from"../chunks/CCffF_dx.js";import"../chunks/pQKmamG3.js";import{k as ae,m as re,p as ze,q as ue,h as L,z as Te,as as De,b as Se,at as Fe,a1 as me,au as W,$ as te,ab as be,ao as qe,av as Ee,c as Ge,a8 as he,d as pe,a9 as ee,ap as je,g as Y,N as m,ae as Ve,a6 as Ye,a7 as ke,y as Ae,x as se,A as Ke,aw as le,F as Le,ax as Je,ay as Qe,D as Xe,az as Ze,f as We,aA as e0,aB as a0,v as r0,o as t0,aC as f0,a5 as n0,aD as o0,aE as s0,a as l0,an as c0,J as _e,S as M,aq as P,U as H,T as B,R as J,K as we,a2 as D,Q as Oe,i as fe,aF as d0}from"../chunks/Cwc0v4sV.js";import{d as Pe,s as Q}from"../chunks/3vagmRDR.js";import{p as ve,i as K,s as ge,b as ne,a as Ie,d as He,c as i0}from"../chunks/CfV7HbxZ.js";import{w as X}from"../chunks/DnlsI8hq.js";let Re=!1;function Me(){Re||(Re=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{var a;if(!e.defaultPrevented)for(const r of e.target.elements)(a=r.__on_r)==null||a.call(r)})},{capture:!0}))}function x0(e){var a=ze,r=ue;ae(null),re(null);try{return e()}finally{ae(a),re(r)}}function u0(e,a,r,t=r){e.addEventListener(a,()=>x0(r));const n=e.__on_r;n?e.__on_r=()=>{n(),t(!0)}:e.__on_r=()=>t(!0),Me()}const ce=0,Z=1,de=2;function b0(e,a,r,t,n){L&&Te();var f=e,c=De(),u=Ge,s=me,l,o,x,i=(c?te:be)(void 0),h=(c?te:be)(void 0),v=!1;function p(d,w){v=!0,w&&(re(E),ae(E),Ee(u));try{d===Z&&t&&(o?he(o):o=pe(()=>t(f,i))),d!==ce&&l&&ee(l,()=>l=null),d!==Z&&o&&ee(o,()=>o=null),d!==de&&x&&ee(x,()=>x=null)}finally{w&&(Ee(null),ae(null),re(null),je())}}var E=Se(()=>{if(s!==(s=a())){if(Fe(s)){var d=s;v=!1,d.then(w=>{d===s&&(W(i,w),p(Z,!0))},w=>{if(d===s)throw W(h,w),p(de,!0),h.v}),L||qe(()=>{v||p(ce,!0)})}else W(i,s),p(Z,!1);return()=>s=me}});L&&(f=Y)}function v0(e,a){return a}function h0(e,a,r,t){for(var n=[],f=a.length,c=0;c<f;c++)Qe(a[c].e,n,!0);var u=f>0&&n.length===0&&r!==null;if(u){var s=r.parentNode;Xe(s),s.append(r),t.clear(),q(e,a[0].prev,a[f-1].next)}Ze(n,()=>{for(var l=0;l<f;l++){var o=a[l];u||(t.delete(o.k),q(e,o.prev,o.next)),We(o.e,!u)}})}function p0(e,a,r,t,n,f=null){var c=e,u={flags:a,items:new Map,first:null};L&&Te();var s=null,l=!1,o=Ve(()=>{var x=r();return t0(x)?x:x==null?[]:Le(x)});Se(()=>{var x=m(o),i=x.length;if(l&&i===0)return;l=i===0;let h=!1;if(L){var v=c.data===Ye;v!==(i===0)&&(c=ke(),Ae(c),se(!1),h=!0)}if(L){for(var p=null,E,d=0;d<i;d++){if(Y.nodeType===8&&Y.data===Ke){c=Y,h=!0,se(!1);break}var w=x[d],k=t(w,d);E=Be(Y,u,p,null,w,k,d,n,a,r),u.items.set(k,E),p=E}i>0&&Ae(ke())}L||_0(x,u,c,n,a,t,r),f!==null&&(i===0?s?he(s):s=pe(()=>f(c)):s!==null&&ee(s,()=>{s=null})),h&&se(!0),m(o)}),L&&(c=Y)}function _0(e,a,r,t,n,f,c){var u=e.length,s=a.items,l=a.first,o=l,x,i=null,h=[],v=[],p,E,d,w;for(w=0;w<u;w+=1){if(p=e[w],E=f(p,w),d=s.get(E),d===void 0){var k=o?o.e.nodes_start:r;i=Be(k,a,i,i===null?a.first:i.next,p,E,w,t,n,c),s.set(E,i),h=[],v=[],o=i.next;continue}if(w0(d,p,w),(d.e.f&le)!==0&&he(d.e),d!==o){if(x!==void 0&&x.has(d)){if(h.length<v.length){var I=v[0],R;i=I.prev;var $=h[0],g=h[h.length-1];for(R=0;R<h.length;R+=1)Ne(h[R],I,r);for(R=0;R<v.length;R+=1)x.delete(v[R]);q(a,$.prev,g.next),q(a,i,$),q(a,g,I),o=I,i=g,w-=1,h=[],v=[]}else x.delete(d),Ne(d,o,r),q(a,d.prev,d.next),q(a,d,i===null?a.first:i.next),q(a,i,d),i=d;continue}for(h=[],v=[];o!==null&&o.k!==E;)(o.e.f&le)===0&&(x??(x=new Set)).add(o),v.push(o),o=o.next;if(o===null)continue;d=o}h.push(d),i=d,o=d.next}if(o!==null||x!==void 0){for(var C=x===void 0?[]:Le(x);o!==null;)(o.e.f&le)===0&&C.push(o),o=o.next;var y=C.length;if(y>0){var S=null;h0(a,C,S,s)}}ue.first=a.first&&a.first.e,ue.last=i&&i.e}function w0(e,a,r,t){W(e.v,a),e.i=r}function Be(e,a,r,t,n,f,c,u,s,l){var o=(s&e0)!==0,x=(s&a0)===0,i=o?x?be(n):te(n):n,h=(s&Je)===0?c:te(c),v={i:h,v:i,k:f,a:null,e:null,prev:r,next:t};try{return v.e=pe(()=>u(e,i,h,l),L),v.e.prev=r&&r.e,v.e.next=t&&t.e,r===null?a.first=v:(r.next=v,r.e.next=v.e),t!==null&&(t.prev=v,t.e.prev=v.e),v}finally{}}function Ne(e,a,r){for(var t=e.next?e.next.e.nodes_start:r,n=a?a.e.nodes_start:r,f=e.e.nodes_start;f!==t;){var c=r0(f);n.before(f),f=c}}function q(e,a,r){a===null?e.first=r:(a.next=r,a.e.next=r&&r.e),r!==null&&(r.prev=a,r.e.prev=a&&a.e)}const Ue=[...` 	
\r\fÂ \v\uFEFF`];function g0(e,a,r){var t=""+e;if(r){for(var n in r)if(r[n])t=t?t+" "+n:n;else if(t.length)for(var f=n.length,c=0;(c=t.indexOf(n,c))>=0;){var u=c+f;(c===0||Ue.includes(t[c-1]))&&(u===t.length||Ue.includes(t[u]))?t=(c===0?"":t.substring(0,c))+t.substring(u+1):c=u}}return t===""?null:t}function y0(e,a,r,t,n,f){var c=e.__className;if(L||c!==r){var u=g0(r,t,f);(!L||u!==e.getAttribute("class"))&&(u==null?e.removeAttribute("class"):e.className=u),e.__className=r}else if(f)for(var s in f){var l=!!f[s];(n==null||l!==!!n[s])&&e.classList.toggle(s,l)}return f}function m0(e){if(L){var a=!1,r=()=>{if(!a){if(a=!0,e.hasAttribute("value")){var t=e.value;oe(e,"value",null),e.value=t}if(e.hasAttribute("checked")){var n=e.checked;oe(e,"checked",null),e.checked=n}}};e.__on_r=r,f0(r),Me()}}function E0(e,a){var r=e.__attributes??(e.__attributes={});r.value===(r.value=a??void 0)||e.value===a&&(a!==0||e.nodeName!=="PROGRESS")||(e.value=a??"")}function oe(e,a,r,t){var n=e.__attributes??(e.__attributes={});L&&(n[a]=e.getAttribute(a),a==="src"||a==="srcset"||a==="href"&&e.nodeName==="LINK")||n[a]!==(n[a]=r)&&(a==="style"&&"__styles"in e&&(e.__styles={}),a==="loading"&&(e[o0]=r),r==null?e.removeAttribute(a):typeof r!="string"&&k0(e).includes(a)?e[a]=r:e.setAttribute(a,r))}var $e=new Map;function k0(e){var a=$e.get(e.nodeName);if(a)return a;$e.set(e.nodeName,a=[]);for(var r,t=e,n=Element.prototype;n!==t;){r=s0(t);for(var f in r)r[f].set&&a.push(f);t=n0(t)}return a}function A0(e,a,r=a){var t=De();u0(e,"input",n=>{var f=n?e.defaultValue:e.value;if(f=ie(e)?xe(f):f,r(f),t&&f!==(f=a())){var c=e.selectionStart,u=e.selectionEnd;e.value=f??"",u!==null&&(e.selectionStart=c,e.selectionEnd=Math.min(u,e.value.length))}}),(L&&e.defaultValue!==e.value||l0(a)==null&&e.value)&&r(ie(e)?xe(e.value):e.value),c0(()=>{var n=a();ie(e)&&n===xe(e.value)||e.type==="date"&&!n&&!e.value||n!==e.value&&(e.value=n??"")})}function ie(e){var a=e.type;return a==="number"||a==="range"}function xe(e){return e===""?null:+e}const I0=[0,79764919,159529838,222504665,319059676,398814059,445009330,507990021,638119352,583659535,797628118,726387553,890018660,835552979,1015980042,944750013,1276238704,1221641927,1167319070,1095957929,1595256236,1540665371,1452775106,1381403509,1780037320,1859660671,1671105958,1733955601,2031960084,2111593891,1889500026,1952343757,2552477408,2632100695,2443283854,2506133561,2334638140,2414271883,2191915858,2254759653,3190512472,3135915759,3081330742,3009969537,2905550212,2850959411,2762807018,2691435357,3560074640,3505614887,3719321342,3648080713,3342211916,3287746299,3467911202,3396681109,4063920168,4143685023,4223187782,4286162673,3779000052,3858754371,3904687514,3967668269,881225847,809987520,1023691545,969234094,662832811,591600412,771767749,717299826,311336399,374308984,453813921,533576470,25881363,88864420,134795389,214552010,2023205639,2086057648,1897238633,1976864222,1804852699,1867694188,1645340341,1724971778,1587496639,1516133128,1461550545,1406951526,1302016099,1230646740,1142491917,1087903418,2896545431,2825181984,2770861561,2716262478,3215044683,3143675388,3055782693,3001194130,2326604591,2389456536,2200899649,2280525302,2578013683,2640855108,2418763421,2498394922,3769900519,3832873040,3912640137,3992402750,4088425275,4151408268,4197601365,4277358050,3334271071,3263032808,3476998961,3422541446,3585640067,3514407732,3694837229,3640369242,1762451694,1842216281,1619975040,1682949687,2047383090,2127137669,1938468188,2001449195,1325665622,1271206113,1183200824,1111960463,1543535498,1489069629,1434599652,1363369299,622672798,568075817,748617968,677256519,907627842,853037301,1067152940,995781531,51762726,131386257,177728840,240578815,269590778,349224269,429104020,491947555,4046411278,4126034873,4172115296,4234965207,3794477266,3874110821,3953728444,4016571915,3609705398,3555108353,3735388376,3664026991,3290680682,3236090077,3449943556,3378572211,3174993278,3120533705,3032266256,2961025959,2923101090,2868635157,2813903052,2742672763,2604032198,2683796849,2461293480,2524268063,2284983834,2364738477,2175806836,2238787779,1569362073,1498123566,1409854455,1355396672,1317987909,1246755826,1192025387,1137557660,2072149281,2135122070,1912620623,1992383480,1753615357,1816598090,1627664531,1707420964,295390185,358241886,404320391,483945776,43990325,106832002,186451547,266083308,932423249,861060070,1041341759,986742920,613929101,542559546,756411363,701822548,3316196985,3244833742,3425377559,3370778784,3601682597,3530312978,3744426955,3689838204,3819031489,3881883254,3928223919,4007849240,4037393693,4100235434,4180117107,4259748804,2310601993,2373574846,2151335527,2231098320,2596047829,2659030626,2470359227,2550115596,2947551409,2876312838,2788305887,2733848168,3165939309,3094707162,3040238851,2985771188],Ce=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215,33554431,67108863,134217727,268435455,536870911,1073741823,-2147483648];function R0(e){const a=[];for(let l=0;l<e.length;l+=1)a.push([l,e[l]]);a.push([e.length,-1]);const r=[];let t=a[0][0],n=a[0][1];for(let l=0;l<a.length;l+=1){const o=a[l][0],x=a[l][1];if(n)for(let i=t;i<o;i+=1)r.push({code:i,bits:n,symbol:void 0});if(t=o,n=x,x===-1)break}r.sort((l,o)=>l.bits-o.bits||l.code-o.code);let f=0,c=-1;const u=[];let s;for(let l=0;l<r.length;l+=1){const o=r[l];c+=1,o.bits!==f&&(c<<=o.bits-f,f=o.bits,s=u[f]={}),o.symbol=c,s[c]=o}return{table:r,fastAccess:u}}function N0(e,a){if(a<0||a>=e.length)throw RangeError("Out of bound");const r=e.slice();e.sort((s,l)=>s-l);const t={};for(let s=e.length-1;s>=0;s-=1)t[e[s]]=s;const n=[];for(let s=0;s<e.length;s+=1)n.push(t[r[s]]++);let f;const c=e[f=a],u=[];for(let s=1;s<e.length;s+=1){const l=e[f=n[f]];l===void 0?u.push(255):u.push(l)}return u.push(c),u.reverse(),u}function U0(e,a=!1){let r=0,t=0,n=0;const f=i=>{if(i>=32){const p=i>>1;return f(p)*(1<<p)+f(i-p)}for(;n<i;)t=(t<<8)+e[r],r+=1,n+=8;const h=Ce[i],v=t>>n-i&h;return n-=i,t&=~(h<<n),v};if(f(16)!==16986)throw new Error("Invalid magic");if(f(8)!==104)throw new Error("Invalid method");let s=f(8);if(s>=49&&s<=57)s-=48;else throw new Error("Invalid blocksize");let l=new Uint8Array(e.length*1.5),o=0,x=-1;for(;;){const i=f(48),h=f(32)|0;if(i===54156738319193){if(f(1))throw new Error("do not support randomised");const v=f(24),p=[],E=f(16);for(let b=32768;b>0;b>>=1){if(!(E&b)){for(let U=0;U<16;U+=1)p.push(!1);continue}const _=f(16);for(let U=32768;U>0;U>>=1)p.push(!!(_&U))}const d=f(3);if(d<2||d>6)throw new Error("Invalid number of huffman groups");const w=f(15),k=[],I=Array.from({length:d},(b,_)=>_);for(let b=0;b<w;b+=1){let _=0;for(;f(1);)if(_+=1,_>=d)throw new Error("MTF table out of range");const U=I[_];for(let V=_;V>0;I[V]=I[--V]);k.push(U),I[0]=U}const R=p.reduce((b,_)=>b+_,0)+2,$=[];for(let b=0;b<d;b+=1){let _=f(5);const U=[];for(let V=0;V<R;V+=1){if(_<0||_>20)throw new Error("Huffman group length outside range");for(;f(1);)_-=f(1)*2-1;U.push(_)}$.push(R0(U))}const g=[];for(let b=0;b<p.length-1;b+=1)p[b]&&g.push(b);let C=0,y=0,S,N,F=0,G=0;const j=[];for(;;){C-=1,C<=0&&(C=50,y<=k.length&&(S=$[k[y]],y+=1));for(const b in S.fastAccess)if(Object.prototype.hasOwnProperty.call(S.fastAccess,b)&&(n<b&&(t=(t<<8)+e[r],r+=1,n+=8),N=S.fastAccess[b][t>>n-b],N)){t&=Ce[n-=b],N=N.code;break}if(N>=0&&N<=1){F===0&&(G=1),F+=G<<N,G<<=1;continue}else{const b=g[0];for(;F>0;F-=1)j.push(b)}if(N===R-1)break;{const b=g[N-1];for(let _=N-1;_>0;g[_]=g[--_]);g[0]=b,j.push(b)}}const T=N0(j,v);let A=0;for(;A<T.length;){const b=T[A];let _=1;if(A<T.length-4&&T[A+1]===b&&T[A+2]===b&&T[A+3]===b?(_=T[A+4]+4,A+=5):A+=1,o+_>=l.length){const U=l;l=new Uint8Array(U.length*2),l.set(U)}for(let U=0;U<_;U+=1)a&&(x=x<<8^I0[(x>>24^b)&255]),l[o]=b,o+=1}if(a){const b=x^-1;if(b!==h)throw new Error(`CRC mismatch: ${b} !== ${h}`);x=-1}}else if(i===25779555029136){f(n&7);break}else throw new Error("Invalid bz2 blocktype")}return l.subarray(0,o)}var $0=z("<p> </p>"),C0=z('<div><!> <progress class="svelte-1wojt58"></progress> <br> <button> </button></div>');function T0(e,a){_e(a,!0);const[r,t]=ge(),n=()=>ne(f(),"$replayUrl",r),f=ve(a,"replayUrl",19,X),c="replay.dem.bz2",u=["Downloading replay...","Processing replay..."];let s=P(!1),l=P(-1),o,x=P(0);async function i(){D(s,!0),await h()}async function h(){D(l,0),o=new AbortController,D(x,0);const $=o.signal;let g=0,C=0;try{const y=await fetch("https://corsproxy.io/"+n(),{signal:$});if(!y.ok)throw new Error("Network response was not ok");if(!y.body)throw new Error("Response body is null");const S=y.body.getReader();C=+(y.headers.get("Content-Length")||0),g=0;const N=[];for(;;){const{done:b,value:_}=await S.read();if(b)break;N.push(_),g+=_.length,D(x,g/C)}const F=await new Blob(N).arrayBuffer(),G=new Uint8Array(F),j=U0(G),T=new Blob([j],{type:"application/octet-stream"}),A=document.createElement("a");A.href=URL.createObjectURL(T),A.download=c,document.body.appendChild(A),A.click(),document.body.removeChild(A)}catch(y){console.log("Some error"+y),p()}}function v(){D(l,-1),o.abort(),p()}function p(){D(x,0),D(s,!1)}var E=C0(),d=M(E);{var w=$=>{var g=$0(),C=M(g,!0);B(g),J(()=>Q(C,u[m(l)])),O($,g)};K(d,$=>{m(l)>=0&&$(w)})}var k=H(d,2);oe(k,"max",1);var I=H(k,4);I.__click=function(...$){var g;(g=m(s)?v:i)==null||g.apply(this,$)};var R=M(I,!0);B(I),B(E),J(()=>{E0(k,m(x)),Q(R,m(s)?"Stop":"Download")}),O(e,E),we(),t()}Pe(["click"]);function D0(e,a,r,t,n,f){D(a,!0),D(r,Ie(t()!=null&&/^[0-9]+$/.test(t().toString()))),D(f,Ie(m(r)?`https://www.opendota.com/request#${t()}`:""))}async function S0(e,a,r,t,n,f,c,u,s){if(!m(a)){D(r,!1),D(a,!0);try{const l=await fetch("https://api.opendota.com/api/matches/"+t());if(!l.ok)throw new Error("Network response was not ok");if(!l.body)throw new Error("Response body is null");const o=await l.json(),x=o.hasOwnProperty("replay_url")?o.replay_url:null;He(c(),x==null?null:new URL(x)),D(u,f()==null),D(a,!1),D(s,!0)}catch{D(a,!1),D(r,!0)}}}var L0=z('<div>It seems that replay is not processed to download yet <br> Open generated link below and wait on opendota site until it finishes processing it <br> <a target="_blank" rel="noopener noreferrer"> </a> <br> Press again "Confirm" after opendota finishes processing</div>'),O0=z('<div style="color: green;">Replay is ready for next step</div>'),P0=z("<!> <!>",1),H0=z('<p style="color: red;">Invalid match id</p>'),M0=z('<div><input type="number" placeholder="Paste your match id here"> <button> </button> <!> <!></div>');function B0(e,a){_e(a,!0);const[r,t]=ge(),n=()=>ne(c(),"$matchId",r),f=()=>ne(u(),"$replayUrl",r),c=ve(a,"matchId",19,X),u=ve(a,"replayUrl",19,X);let s=P(!0),l=P(!1),o=P(!1),x=P(!1),i=Oe(()=>()=>m(s)&&m(l)&&!m(o)),h=P(!1),v=P(!1),p=P("");var E=M0(),d=M(E);m0(d),d.__input=[D0,l,s,n,c,p];let w;var k=H(d,2);k.__click=[S0,o,x,n,c,f,u,v,h];var I=M(k,!0);B(k);var R=H(k,2);{var $=y=>{var S=P0(),N=fe(S);{var F=T=>{var A=L0(),b=H(M(A),5),_=M(b,!0);B(b),d0(3),B(A),J(()=>{oe(b,"href",m(p)),Q(_,m(p))}),O(T,A)};K(N,T=>{m(v)&&T(F)})}var G=H(N,2);{var j=T=>{var A=O0();O(T,A)};K(G,T=>{m(v)||T(j)})}O(y,S)};K(R,y=>{m(h)&&y($)})}var g=H(R,2);{var C=y=>{var S=H0();O(y,S)};K(g,y=>{m(s)||y(C)})}B(E),J(y=>{w=y0(d,1,"svelte-1a8kz8y",null,w,{invalid:!m(s)}),k.disabled=y,Q(I,m(x)?"Try again":"Confirm")},[()=>!m(i)()]),A0(d,n,y=>He(c(),y)),O(e,E),we(),t()}Pe(["input","click"]);var z0=z("<li><p> </p> <!></li>"),F0=z('<ol><div style="display: flex; align-items: center;"></div> <!></ol>');function q0(e,a){_e(a,!0);const[r,t]=ge(),n=()=>ne(u,"$replayUrl",r);let f=Oe(()=>()=>[{text:"Enter your match id"},n()==null?null:{text:"Let it process and download"}].filter(x=>x!=null)),c=X(),u=X(null);function s(x){return[B0,T0][x]}var l=F0(),o=H(M(l),2);p0(o,17,()=>m(f)(),v0,(x,i,h)=>{var v=z0(),p=M(v),E=M(p,!0);B(p);var d=H(p,2);b0(d,()=>Promise.resolve(s(h)),null,(w,k)=>{var I=ye(),R=fe(I);{var $=g=>{var C=ye(),y=fe(C);i0(y,()=>m(k),(S,N)=>{N(S,{matchId:c,replayUrl:u})}),O(g,C)};K(R,g=>{m(k)&&g($)})}O(w,I)}),B(v),J(()=>Q(E,m(i).text)),O(x,v)}),B(l),O(e,l),we(),t()}var G0=z("<h1>OpenDotaReplayHandler</h1> <h2>Early super slow prototype edition</h2> <!>",1);function X0(e){var a=G0(),r=H(fe(a),4);q0(r,{}),O(e,a)}export{X0 as component};

import{t as z,a as O,c as Ee}from"../chunks/CCffF_dx.js";import"../chunks/pQKmamG3.js";import{k as re,m as fe,p as ze,q as be,h as L,z as Se,as as Le,b as Pe,at as qe,a1 as ke,au as ae,$ as ne,ab as ve,ao as Ge,av as Ie,c as je,a8 as he,d as pe,a9 as te,ap as Ve,g as K,N as m,ae as Ye,a6 as Ke,a7 as Ae,y as Re,x as le,A as Je,aw as de,F as Oe,ax as Qe,ay as Xe,D as Ze,az as We,f as e0,aA as a0,aB as t0,v as r0,o as f0,aC as n0,a5 as o0,aD as s0,aE as l0,a as d0,an as c0,J as _e,S as B,aq as H,U as M,T as F,R as Z,K as we,a2 as N,Q as He,i as oe,aF as i0}from"../chunks/Cwc0v4sV.js";import{d as Me,s as W}from"../chunks/3vagmRDR.js";import{p as X,i as J,s as ge,b as ye,d as Q,a as De,c as x0}from"../chunks/kMYQBFqW.js";import{w as Y}from"../chunks/DnlsI8hq.js";let Ne=!1;function Be(){Ne||(Ne=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{var a;if(!e.defaultPrevented)for(const t of e.target.elements)(a=t.__on_r)==null||a.call(t)})},{capture:!0}))}function u0(e){var a=ze,t=be;re(null),fe(null);try{return e()}finally{re(a),fe(t)}}function b0(e,a,t,f=t){e.addEventListener(a,()=>u0(t));const n=e.__on_r;n?e.__on_r=()=>{n(),f(!0)}:e.__on_r=()=>f(!0),Be()}const ce=0,ee=1,ie=2;function v0(e,a,t,f,n){L&&Se();var r=e,c=Le(),u=je,s=ke,l,o,x,d=(c?ne:ve)(void 0),v=(c?ne:ve)(void 0),h=!1;function p(i,w){h=!0,w&&(fe(E),re(E),Ie(u));try{i===ee&&f&&(o?he(o):o=pe(()=>f(r,d))),i!==ce&&l&&te(l,()=>l=null),i!==ee&&o&&te(o,()=>o=null),i!==ie&&x&&te(x,()=>x=null)}finally{w&&(Ie(null),re(null),fe(null),Ve())}}var E=Pe(()=>{if(s!==(s=a())){if(qe(s)){var i=s;h=!1,i.then(w=>{i===s&&(ae(d,w),p(ee,!0))},w=>{if(i===s)throw ae(v,w),p(ie,!0),v.v}),L||Ge(()=>{h||p(ce,!0)})}else ae(d,s),p(ee,!1);return()=>s=ke}});L&&(r=K)}function h0(e,a){return a}function p0(e,a,t,f){for(var n=[],r=a.length,c=0;c<r;c++)Xe(a[c].e,n,!0);var u=r>0&&n.length===0&&t!==null;if(u){var s=t.parentNode;Ze(s),s.append(t),f.clear(),V(e,a[0].prev,a[r-1].next)}We(n,()=>{for(var l=0;l<r;l++){var o=a[l];u||(f.delete(o.k),V(e,o.prev,o.next)),e0(o.e,!u)}})}function _0(e,a,t,f,n,r=null){var c=e,u={flags:a,items:new Map,first:null};L&&Se();var s=null,l=!1,o=Ye(()=>{var x=t();return f0(x)?x:x==null?[]:Oe(x)});Pe(()=>{var x=m(o),d=x.length;if(l&&d===0)return;l=d===0;let v=!1;if(L){var h=c.data===Ke;h!==(d===0)&&(c=Ae(),Re(c),le(!1),v=!0)}if(L){for(var p=null,E,i=0;i<d;i++){if(K.nodeType===8&&K.data===Je){c=K,v=!0,le(!1);break}var w=x[i],I=f(w,i);E=Fe(K,u,p,null,w,I,i,n,a,t),u.items.set(I,E),p=E}d>0&&Re(Ae())}L||w0(x,u,c,n,a,f,t),r!==null&&(d===0?s?he(s):s=pe(()=>r(c)):s!==null&&te(s,()=>{s=null})),v&&le(!0),m(o)}),L&&(c=K)}function w0(e,a,t,f,n,r,c){var u=e.length,s=a.items,l=a.first,o=l,x,d=null,v=[],h=[],p,E,i,w;for(w=0;w<u;w+=1){if(p=e[w],E=r(p,w),i=s.get(E),i===void 0){var I=o?o.e.nodes_start:t;d=Fe(I,a,d,d===null?a.first:d.next,p,E,w,f,n,c),s.set(E,d),v=[],h=[],o=d.next;continue}if(g0(i,p,w),(i.e.f&de)!==0&&he(i.e),i!==o){if(x!==void 0&&x.has(i)){if(v.length<h.length){var $=h[0],R;d=$.prev;var S=v[0],D=v[v.length-1];for(R=0;R<v.length;R+=1)Ce(v[R],$,t);for(R=0;R<h.length;R+=1)x.delete(h[R]);V(a,S.prev,D.next),V(a,d,S),V(a,D,$),o=$,d=D,w-=1,v=[],h=[]}else x.delete(i),Ce(i,o,t),V(a,i.prev,i.next),V(a,i,d===null?a.first:d.next),V(a,d,i),d=i;continue}for(v=[],h=[];o!==null&&o.k!==E;)(o.e.f&de)===0&&(x??(x=new Set)).add(o),h.push(o),o=o.next;if(o===null)continue;i=o}v.push(i),d=i,o=i.next}if(o!==null||x!==void 0){for(var P=x===void 0?[]:Oe(x);o!==null;)(o.e.f&de)===0&&P.push(o),o=o.next;var _=P.length;if(_>0){var y=null;p0(a,P,y,s)}}be.first=a.first&&a.first.e,be.last=d&&d.e}function g0(e,a,t,f){ae(e.v,a),e.i=t}function Fe(e,a,t,f,n,r,c,u,s,l){var o=(s&a0)!==0,x=(s&t0)===0,d=o?x?ve(n):ne(n):n,v=(s&Qe)===0?c:ne(c),h={i:v,v:d,k:r,a:null,e:null,prev:t,next:f};try{return h.e=pe(()=>u(e,d,v,l),L),h.e.prev=t&&t.e,h.e.next=f&&f.e,t===null?a.first=h:(t.next=h,t.e.next=h.e),f!==null&&(f.prev=h,f.e.prev=h.e),h}finally{}}function Ce(e,a,t){for(var f=e.next?e.next.e.nodes_start:t,n=a?a.e.nodes_start:t,r=e.e.nodes_start;r!==f;){var c=r0(r);n.before(r),r=c}}function V(e,a,t){a===null?e.first=t:(a.next=t,a.e.next=t&&t.e),t!==null&&(t.prev=a,t.e.prev=a&&a.e)}const Ue=[...` 	
\r\fÂ \v\uFEFF`];function y0(e,a,t){var f=""+e;if(t){for(var n in t)if(t[n])f=f?f+" "+n:n;else if(f.length)for(var r=n.length,c=0;(c=f.indexOf(n,c))>=0;){var u=c+r;(c===0||Ue.includes(f[c-1]))&&(u===f.length||Ue.includes(f[u]))?f=(c===0?"":f.substring(0,c))+f.substring(u+1):c=u}}return f===""?null:f}function m0(e,a,t,f,n,r){var c=e.__className;if(L||c!==t){var u=y0(t,f,r);(!L||u!==e.getAttribute("class"))&&(u==null?e.removeAttribute("class"):e.className=u),e.__className=t}else if(r)for(var s in r){var l=!!r[s];(n==null||l!==!!n[s])&&e.classList.toggle(s,l)}return r}function E0(e){if(L){var a=!1,t=()=>{if(!a){if(a=!0,e.hasAttribute("value")){var f=e.value;se(e,"value",null),e.value=f}if(e.hasAttribute("checked")){var n=e.checked;se(e,"checked",null),e.checked=n}}};e.__on_r=t,n0(t),Be()}}function k0(e,a){var t=e.__attributes??(e.__attributes={});t.value===(t.value=a??void 0)||e.value===a&&(a!==0||e.nodeName!=="PROGRESS")||(e.value=a??"")}function se(e,a,t,f){var n=e.__attributes??(e.__attributes={});L&&(n[a]=e.getAttribute(a),a==="src"||a==="srcset"||a==="href"&&e.nodeName==="LINK")||n[a]!==(n[a]=t)&&(a==="style"&&"__styles"in e&&(e.__styles={}),a==="loading"&&(e[s0]=t),t==null?e.removeAttribute(a):typeof t!="string"&&I0(e).includes(a)?e[a]=t:e.setAttribute(a,t))}var $e=new Map;function I0(e){var a=$e.get(e.nodeName);if(a)return a;$e.set(e.nodeName,a=[]);for(var t,f=e,n=Element.prototype;n!==f;){t=l0(f);for(var r in t)t[r].set&&a.push(r);f=o0(f)}return a}function A0(e,a,t=a){var f=Le();b0(e,"input",n=>{var r=n?e.defaultValue:e.value;if(r=xe(e)?ue(r):r,t(r),f&&r!==(r=a())){var c=e.selectionStart,u=e.selectionEnd;e.value=r??"",u!==null&&(e.selectionStart=c,e.selectionEnd=Math.min(u,e.value.length))}}),(L&&e.defaultValue!==e.value||d0(a)==null&&e.value)&&t(xe(e)?ue(e.value):e.value),c0(()=>{var n=a();xe(e)&&n===ue(e.value)||e.type==="date"&&!n&&!e.value||n!==e.value&&(e.value=n??"")})}function xe(e){var a=e.type;return a==="number"||a==="range"}function ue(e){return e===""?null:+e}const R0=[0,79764919,159529838,222504665,319059676,398814059,445009330,507990021,638119352,583659535,797628118,726387553,890018660,835552979,1015980042,944750013,1276238704,1221641927,1167319070,1095957929,1595256236,1540665371,1452775106,1381403509,1780037320,1859660671,1671105958,1733955601,2031960084,2111593891,1889500026,1952343757,2552477408,2632100695,2443283854,2506133561,2334638140,2414271883,2191915858,2254759653,3190512472,3135915759,3081330742,3009969537,2905550212,2850959411,2762807018,2691435357,3560074640,3505614887,3719321342,3648080713,3342211916,3287746299,3467911202,3396681109,4063920168,4143685023,4223187782,4286162673,3779000052,3858754371,3904687514,3967668269,881225847,809987520,1023691545,969234094,662832811,591600412,771767749,717299826,311336399,374308984,453813921,533576470,25881363,88864420,134795389,214552010,2023205639,2086057648,1897238633,1976864222,1804852699,1867694188,1645340341,1724971778,1587496639,1516133128,1461550545,1406951526,1302016099,1230646740,1142491917,1087903418,2896545431,2825181984,2770861561,2716262478,3215044683,3143675388,3055782693,3001194130,2326604591,2389456536,2200899649,2280525302,2578013683,2640855108,2418763421,2498394922,3769900519,3832873040,3912640137,3992402750,4088425275,4151408268,4197601365,4277358050,3334271071,3263032808,3476998961,3422541446,3585640067,3514407732,3694837229,3640369242,1762451694,1842216281,1619975040,1682949687,2047383090,2127137669,1938468188,2001449195,1325665622,1271206113,1183200824,1111960463,1543535498,1489069629,1434599652,1363369299,622672798,568075817,748617968,677256519,907627842,853037301,1067152940,995781531,51762726,131386257,177728840,240578815,269590778,349224269,429104020,491947555,4046411278,4126034873,4172115296,4234965207,3794477266,3874110821,3953728444,4016571915,3609705398,3555108353,3735388376,3664026991,3290680682,3236090077,3449943556,3378572211,3174993278,3120533705,3032266256,2961025959,2923101090,2868635157,2813903052,2742672763,2604032198,2683796849,2461293480,2524268063,2284983834,2364738477,2175806836,2238787779,1569362073,1498123566,1409854455,1355396672,1317987909,1246755826,1192025387,1137557660,2072149281,2135122070,1912620623,1992383480,1753615357,1816598090,1627664531,1707420964,295390185,358241886,404320391,483945776,43990325,106832002,186451547,266083308,932423249,861060070,1041341759,986742920,613929101,542559546,756411363,701822548,3316196985,3244833742,3425377559,3370778784,3601682597,3530312978,3744426955,3689838204,3819031489,3881883254,3928223919,4007849240,4037393693,4100235434,4180117107,4259748804,2310601993,2373574846,2151335527,2231098320,2596047829,2659030626,2470359227,2550115596,2947551409,2876312838,2788305887,2733848168,3165939309,3094707162,3040238851,2985771188],Te=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215,33554431,67108863,134217727,268435455,536870911,1073741823,-2147483648];function D0(e){const a=[];for(let l=0;l<e.length;l+=1)a.push([l,e[l]]);a.push([e.length,-1]);const t=[];let f=a[0][0],n=a[0][1];for(let l=0;l<a.length;l+=1){const o=a[l][0],x=a[l][1];if(n)for(let d=f;d<o;d+=1)t.push({code:d,bits:n,symbol:void 0});if(f=o,n=x,x===-1)break}t.sort((l,o)=>l.bits-o.bits||l.code-o.code);let r=0,c=-1;const u=[];let s;for(let l=0;l<t.length;l+=1){const o=t[l];c+=1,o.bits!==r&&(c<<=o.bits-r,r=o.bits,s=u[r]={}),o.symbol=c,s[c]=o}return{table:t,fastAccess:u}}function N0(e,a){if(a<0||a>=e.length)throw RangeError("Out of bound");const t=e.slice();e.sort((s,l)=>s-l);const f={};for(let s=e.length-1;s>=0;s-=1)f[e[s]]=s;const n=[];for(let s=0;s<e.length;s+=1)n.push(f[t[s]]++);let r;const c=e[r=a],u=[];for(let s=1;s<e.length;s+=1){const l=e[r=n[r]];l===void 0?u.push(255):u.push(l)}return u.push(c),u.reverse(),u}function C0(e,a=!1){let t=0,f=0,n=0;const r=d=>{if(d>=32){const p=d>>1;return r(p)*(1<<p)+r(d-p)}for(;n<d;)f=(f<<8)+e[t],t+=1,n+=8;const v=Te[d],h=f>>n-d&v;return n-=d,f&=~(v<<n),h};if(r(16)!==16986)throw new Error("Invalid magic");if(r(8)!==104)throw new Error("Invalid method");let s=r(8);if(s>=49&&s<=57)s-=48;else throw new Error("Invalid blocksize");let l=new Uint8Array(e.length*1.5),o=0,x=-1;for(;;){const d=r(48),v=r(32)|0;if(d===54156738319193){if(r(1))throw new Error("do not support randomised");const h=r(24),p=[],E=r(16);for(let b=32768;b>0;b>>=1){if(!(E&b)){for(let k=0;k<16;k+=1)p.push(!1);continue}const g=r(16);for(let k=32768;k>0;k>>=1)p.push(!!(g&k))}const i=r(3);if(i<2||i>6)throw new Error("Invalid number of huffman groups");const w=r(15),I=[],$=Array.from({length:i},(b,g)=>g);for(let b=0;b<w;b+=1){let g=0;for(;r(1);)if(g+=1,g>=i)throw new Error("MTF table out of range");const k=$[g];for(let j=g;j>0;$[j]=$[--j]);I.push(k),$[0]=k}const R=p.reduce((b,g)=>b+g,0)+2,S=[];for(let b=0;b<i;b+=1){let g=r(5);const k=[];for(let j=0;j<R;j+=1){if(g<0||g>20)throw new Error("Huffman group length outside range");for(;r(1);)g-=r(1)*2-1;k.push(g)}S.push(D0(k))}const D=[];for(let b=0;b<p.length-1;b+=1)p[b]&&D.push(b);let P=0,_=0,y,A,T=0,q=0;const G=[];for(;;){P-=1,P<=0&&(P=50,_<=I.length&&(y=S[I[_]],_+=1));for(const b in y.fastAccess)if(Object.prototype.hasOwnProperty.call(y.fastAccess,b)&&(n<b&&(f=(f<<8)+e[t],t+=1,n+=8),A=y.fastAccess[b][f>>n-b],A)){f&=Te[n-=b],A=A.code;break}if(A>=0&&A<=1){T===0&&(q=1),T+=q<<A,q<<=1;continue}else{const b=D[0];for(;T>0;T-=1)G.push(b)}if(A===R-1)break;{const b=D[A-1];for(let g=A-1;g>0;D[g]=D[--g]);D[0]=b,G.push(b)}}const C=N0(G,h);let U=0;for(;U<C.length;){const b=C[U];let g=1;if(U<C.length-4&&C[U+1]===b&&C[U+2]===b&&C[U+3]===b?(g=C[U+4]+4,U+=5):U+=1,o+g>=l.length){const k=l;l=new Uint8Array(k.length*2),l.set(k)}for(let k=0;k<g;k+=1)a&&(x=x<<8^R0[(x>>24^b)&255]),l[o]=b,o+=1}if(a){const b=x^-1;if(b!==v)throw new Error(`CRC mismatch: ${b} !== ${v}`);x=-1}}else if(d===25779555029136){r(n&7);break}else throw new Error("Invalid bz2 blocktype")}return l.subarray(0,o)}var U0=z("<p> </p>"),$0=z('<div><!> <progress class="svelte-1wojt58"></progress> <br> <button> </button></div>');function T0(e,a){_e(a,!0);const[t,f]=ge(),n=()=>Q(u(),"$replayUrl",t),r=()=>Q(c(),"$matchId",t),c=X(a,"matchId",19,Y),u=X(a,"replayUrl",19,Y),s=X(a,"startedDownload",19,Y),l=".dem",o=["Downloading replay...","Processing replay..."];let x=H(!1),d=H(-1),v,h=H(0);async function p(){N(x,!0),ye(s(),!0),await E()}async function E(){N(d,0),v=new AbortController,N(h,0);const _=v.signal;let y=0,A=0;try{const T=await fetch("https://corsproxy.io/"+n(),{signal:_});if(!T.ok)throw new Error("Network response was not ok");if(!T.body)throw new Error("Response body is null");const q=T.body.getReader();A=+(T.headers.get("Content-Length")||0),y=0;const G=[];for(;;){const{done:j,value:me}=await q.read();if(j)break;G.push(me),y+=me.length,N(h,y/A)}N(d,1);const C=await new Blob(G).arrayBuffer(),U=new Uint8Array(C),b=C0(U),g=new Blob([b],{type:"application/octet-stream"}),k=document.createElement("a");k.href=URL.createObjectURL(g),k.download=r()+l,document.body.appendChild(k),k.click(),document.body.removeChild(k)}catch(T){console.log("Some error"+T),w()}}function i(){N(d,-1),v.abort(),w()}function w(){N(h,0),N(x,!1)}var I=$0(),$=B(I);{var R=_=>{var y=U0(),A=B(y,!0);F(y),Z(()=>W(A,o[m(d)])),O(_,y)};J($,_=>{m(d)>=0&&_(R)})}var S=M($,2);se(S,"max",1);var D=M(S,4);D.__click=function(..._){var y;(y=m(x)?i:p)==null||y.apply(this,_)};var P=B(D,!0);F(D),F(I),Z(()=>{k0(S,m(h)),W(P,m(x)?"Stop":"Download")}),O(e,I),we(),f()}Me(["click"]);function S0(e,a,t,f,n,r){N(a,!0),N(t,De(f()!=null&&/^[0-9]+$/.test(f().toString()))),N(r,De(m(t)?`https://www.opendota.com/request#${f()}`:""))}async function L0(e,a,t,f,n,r,c,u,s){if(!m(a)){N(t,!1),N(a,!0);try{const l=await fetch("https://api.opendota.com/api/matches/"+f());if(!l.ok)throw new Error("Network response was not ok");if(!l.body)throw new Error("Response body is null");const o=await l.json(),x=o.hasOwnProperty("replay_url")?o.replay_url:null;ye(c(),x==null?null:new URL(x)),N(u,r()==null),N(a,!1),N(s,!0)}catch{N(a,!1),N(t,!0)}}}var P0=z('<div>It seems that replay is not processed to download yet <br> Open generated link below and wait on opendota site until it finishes processing it <br> <a target="_blank" rel="noopener noreferrer"> </a> <br> Press again "Confirm" after opendota finishes processing</div>'),O0=z('<div style="color: green;">Replay is ready for next step</div>'),H0=z("<!> <!>",1),M0=z('<p style="color: red;">Invalid match id</p>'),B0=z('<div><input type="number" placeholder="Paste your match id here"> <button> </button> <!> <!></div>');function F0(e,a){_e(a,!0);const[t,f]=ge(),n=()=>Q(c(),"$matchId",t),r=()=>Q(u(),"$replayUrl",t),c=X(a,"matchId",19,Y),u=X(a,"replayUrl",19,Y);let s=H(!0),l=H(!1),o=H(!1),x=H(!1),d=He(()=>()=>m(s)&&m(l)&&!m(o)),v=H(!1),h=H(!1),p=H("");var E=B0(),i=B(E);E0(i),i.__input=[S0,l,s,n,c,p];let w;var I=M(i,2);I.__click=[L0,o,x,n,c,r,u,h,v];var $=B(I,!0);F(I);var R=M(I,2);{var S=_=>{var y=H0(),A=oe(y);{var T=C=>{var U=P0(),b=M(B(U),5),g=B(b,!0);F(b),i0(3),F(U),Z(()=>{se(b,"href",m(p)),W(g,m(p))}),O(C,U)};J(A,C=>{m(h)&&C(T)})}var q=M(A,2);{var G=C=>{var U=O0();O(C,U)};J(q,C=>{m(h)||C(G)})}O(_,y)};J(R,_=>{m(v)&&_(S)})}var D=M(R,2);{var P=_=>{var y=M0();O(_,y)};J(D,_=>{m(s)||_(P)})}F(E),Z(_=>{w=m0(i,1,"svelte-1a8kz8y",null,w,{invalid:!m(s)}),I.disabled=_,W($,m(x)?"Try again":"Confirm")},[()=>!m(d)()]),A0(i,n,_=>ye(c(),_)),O(e,E),we(),f()}Me(["input","click"]);var z0=z("<li><p> </p> <!></li>"),q0=z('<ol><div style="display: flex; align-items: center;"></div> <!></ol>');function G0(e,a){_e(a,!0);const[t,f]=ge(),n=()=>Q(s,"$replayUrl",t),r=()=>Q(l,"$startedDownload",t);let c=He(()=>()=>[{text:"Enter your match id"},n()==null?null:{text:"Let it process and download"},r()==null?null:{text:"Paste it to your Dota 2 replay directory, e.g.: `C:\\Program Files (x86)\\Steam\\steamapps\\common\\dota 2 beta\\game\\dota\\replays\\`"},r()==null?null:{text:"Run game and find your replay in `watch` > `replays' > `saved to watch later` > `downloads`"}].filter(v=>v!=null)),u=Y(),s=Y(null),l=Y();function o(v){return[F0,T0][v]}var x=q0(),d=M(B(x),2);_0(d,17,()=>m(c)(),h0,(v,h,p)=>{var E=z0(),i=B(E),w=B(i,!0);F(i);var I=M(i,2);v0(I,()=>Promise.resolve(o(p)),null,($,R)=>{var S=Ee(),D=oe(S);{var P=_=>{var y=Ee(),A=oe(y);x0(A,()=>m(R),(T,q)=>{q(T,{matchId:u,replayUrl:s,startedDownload:l})}),O(_,y)};J(D,_=>{m(R)&&_(P)})}O($,S)}),F(E),Z(()=>W(w,m(h).text)),O(v,E)}),F(x),O(e,x),we(),f()}var j0=z("<h1>OpenDotaReplayHandler</h1> <h2>Early super slow prototype edition</h2> <!>",1);function Z0(e){var a=j0(),t=M(oe(a),4);G0(t,{}),O(e,a)}export{Z0 as component};
